#!/bin/sh

prefix=/usr/local

echo "Checking for gcc.."
if ! command -v gcc >/dev/null 2>&1; then
	echo "gcc not found!"
	exit 1
fi

echo "Creating Makefile with prefix=$prefix..."
cat > Makefile <<'EOF'
CC=gcc
CFLAGS=-Wall -Wextra -O2
PREFIX='"$prefix"'

all: sysprobe

sysprobe: source/main.c source/cpu.c source/mem.c source/disk.c
	$(CC) $(CFLAGS) -o sysprobe source/main.c source/cpu.c source/mem.c source/disk.c

install: sysprobe
	mkdir -p $(PREFIX)/bin
	cp sysprobe $(PREFIX)/bin/

uninstall:
	rm -r $(PREFIX)/bin/sysprobe
clean:
	rm -r sysprobe

EOF
